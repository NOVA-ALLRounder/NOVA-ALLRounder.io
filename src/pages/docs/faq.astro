---
import DocsLayout from '../../layouts/DocsLayout.astro';
const repo = process.env.GITHUB_REPOSITORY?.split('/')[1] ?? '';
const isUserSiteRepo = repo.endsWith('.github.io');
const basePath = process.env.GITHUB_ACTIONS === 'true'
  ? (isUserSiteRepo ? '/' : `/${repo}/`)
  : '/';
const withBase = (url: string) => {
  if (!url.startsWith('/')) return url;
  const clean = url.replace(/^\/+/, '');
  return clean ? `${basePath}${clean}` : basePath;
};
---

<DocsLayout title="FAQ" description="NOVA 사용 시 자주 묻는 질문과 답변. 설치, 보안, 성능, 트러블슈팅.">
  <h1>FAQ</h1>
  <p class="doc-subtitle">NOVA를 사용하면서 자주 접하는 질문과 해결 방법을 정리했습니다.</p>

  <h2>일반</h2>

  <h3>NOVA는 무엇인가요?</h3>
  <p>NOVA는 <strong>사용자 행동 기반 자동화 에이전트</strong>입니다. 컴퓨터 사용 패턴을 OS 수준에서 분석하여 반복 작업을 자동으로 감지하고, AI가 최적의 자동화를 추천 및 실행합니다. Rust로 작성된 네이티브 바이너리로 안정성과 성능을 보장합니다.</p>

  <h3>어떤 운영체제를 지원하나요?</h3>
  <p><strong>macOS 12+</strong> (Monterey 이상)을 주력 지원하며, <strong>Windows 10+</strong>도 PowerShell 스크립트를 통해 지원합니다. Rust 네이티브 빌드이므로 Linux에서도 빌드 가능하지만, 공식 지원 범위는 macOS와 Windows입니다.</p>

  <h3>오프라인에서도 사용할 수 있나요?</h3>
  <p>데이터 수집(<code>routine</code>, <code>status</code>)과 앱 제어(<code>control</code>, <code>exec</code>)는 오프라인에서 동작합니다. 단, LLM 기반 분석(<code>recommend</code>)과 워크플로우 생성(<code>build_workflow</code>)에는 OpenAI API 연결이 필요합니다. 완전한 오프라인 모드는 향후 로드맵에 포함되어 있습니다.</p>

  <h3>무료로 사용할 수 있나요?</h3>
  <p>NOVA 코어 에이전트는 <strong>오픈소스</strong>이며 무료로 사용할 수 있습니다. 클라우드 API (자동화 관리, AI 분류 모델 등)는 플랜별로 이용 한도가 다릅니다. 자세한 내용은 <a href={withBase('/pricing')}>Pricing</a> 페이지를 확인하세요.</p>

  <hr />

  <h2>설치 & 설정</h2>

  <h3>OpenAI API Key가 반드시 필요한가요?</h3>
  <p>네. LLM 기반 행동 패턴 분석(<code>analyzer.rs</code>)과 자연어 워크플로우 생성(<code>build_workflow</code>)에 OpenAI API를 사용합니다. <code>.env</code> 파일에 <code>OPENAI_API_KEY</code>를 설정해야 합니다. GPT-3.5와 GPT-4 모두 지원합니다.</p>

  <h3>macOS에서 Accessibility 권한은 왜 필요한가요?</h3>
  <p>OS 센서가 앱 전환, 활성 윈도우, 시스템 이벤트를 수집하기 위해 macOS의 Accessibility API를 사용합니다. <strong>시스템 환경설정 → 개인정보 보호 및 보안 → 손쉬운 사용</strong>에서 터미널 앱에 권한을 부여하세요.</p>

  <h3>n8n 없이도 사용할 수 있나요?</h3>
  <p>네. n8n은 <strong>선택적 워크플로우 오케스트레이션 레이어</strong>입니다. 코어 에이전트의 핵심 기능(<code>routine</code>, <code>recommend</code>, <code>exec</code>, <code>control</code>)은 n8n 없이 독립적으로 동작합니다. n8n은 복잡한 멀티스텝 워크플로우를 시각적으로 관리하고 싶을 때 추가하세요.</p>

  <h3>빌드에 실패합니다</h3>
  <p>다음 사항을 확인하세요:</p>
  <ul>
    <li>Rust 버전이 1.70 이상인지 확인: <code>rustup update && rustc --version</code></li>
    <li>Xcode Command Line Tools 설치 (macOS): <code>xcode-select --install</code></li>
    <li>Visual Studio C++ Build Tools 설치 (Windows)</li>
    <li>네트워크 연결 상태 확인 (Cargo 의존성 다운로드 필요)</li>
  </ul>

  <hr />

  <h2>보안 & 데이터</h2>

  <h3>보안은 어떻게 처리되나요?</h3>
  <p>NOVA는 다층 보안 모델을 사용합니다:</p>
  <ul>
    <li><strong>command 차단:</strong> <code>exec</code> 명령어에서 <code>rm</code>, <code>sudo</code>, <code>format</code> 등 위험한 키워드를 자동 차단</li>
    <li><strong>Write Lock:</strong> 기본적으로 활성화되어 있어, 파일 시스템 변경이 필요한 명령은 <code>unlock</code> 후에만 실행 가능</li>
    <li><strong>정책 엔진:</strong> <code>policy.rs</code>에서 허용/차단 규칙을 세밀하게 관리</li>
    <li><strong>감사 로그:</strong> 모든 명령어 실행 이력이 SQLite에 기록</li>
  </ul>

  <h3>수집된 데이터는 어디에 저장되나요?</h3>
  <p>모든 데이터는 <strong>로컬 SQLite 데이터베이스</strong>(<code>steer.db</code>)에 저장됩니다. 외부 서버로 데이터가 전송되지 않습니다. LLM 분석 시에만 패턴 요약 데이터가 OpenAI API로 전송되며, 원시 이벤트 데이터는 전송되지 않습니다.</p>

  <h3>데이터 보관 기간은?</h3>
  <p>Rust Collector는 다음과 같은 데이터 라이프사이클을 관리합니다:</p>
  <ul>
    <li><strong>원시 이벤트:</strong> 30일 보관 후 자동 삭제</li>
    <li><strong>5분 집약 데이터:</strong> 90일 보관</li>
    <li><strong>일일 요약:</strong> 1년 보관</li>
    <li><strong>실행 이력:</strong> 영구 보관 (수동 삭제 가능)</li>
  </ul>

  <hr />

  <h2>성능 & 확장</h2>

  <h3>API Rate Limit은 어떻게 되나요?</h3>
  <table>
    <thead>
      <tr><th>플랜</th><th>분당 호출</th><th>일일 한도</th></tr>
    </thead>
    <tbody>
      <tr><td>Individual</td><td>60회</td><td>10,000회</td></tr>
      <tr><td>Team</td><td>300회</td><td>50,000회</td></tr>
      <tr><td>Enterprise</td><td>협의</td><td>무제한</td></tr>
    </tbody>
  </table>

  <h3>에이전트가 시스템 리소스에 영향을 주나요?</h3>
  <p>NOVA는 Rust 네이티브 바이너리로, 일반적으로 <strong>CPU 1% 미만, 메모리 50MB 이하</strong>를 사용합니다. Collector의 데이터 수집은 비동기로 동작하며 백그라운드에서 실행됩니다.</p>

  <h3>팀에서 함께 사용할 수 있나요?</h3>
  <p>네. 다음 방법으로 팀 규모 배포가 가능합니다:</p>
  <ul>
    <li><strong>Tauri 데스크톱 앱:</strong> .app / .exe로 번들하여 팀원에게 배포</li>
    <li><strong>n8n 워크플로우 공유:</strong> 팀 전체가 동일한 자동화 워크플로우를 사용</li>
    <li><strong>Self-Healing Guardian:</strong> <code>steer-guardian.sh</code>가 크래시 시 자동 재시작 보장</li>
  </ul>

  <hr />

  <h2>트러블슈팅</h2>

  <h3>자동화가 실행되지 않습니다</h3>
  <p>다음을 순서대로 확인하세요:</p>
  <ol>
    <li><code>status</code> 명령어로 에이전트가 정상 동작 중인지 확인</li>
    <li>트리거 설정이 올바른지 확인 (Webhook URL, 스케줄 등)</li>
    <li>커넥터 인증이 만료되지 않았는지 확인</li>
    <li>Write Lock 상태 확인 — 필요 시 <code>unlock</code> 실행</li>
    <li>실행 이력에서 에러 메시지 확인: <code>GET /automations/:id/runs?status=error</code></li>
  </ol>

  <h3>처리 속도가 느립니다</h3>
  <p>다음 최적화를 시도하세요:</p>
  <ul>
    <li><strong>배치 모드 활성화:</strong> 대량 데이터 처리 시 배치 분석으로 전환</li>
    <li><strong>Release 빌드 확인:</strong> <code>cargo build --release</code>로 최적화된 바이너리 사용</li>
    <li><strong>DB 인덱스 확인:</strong> <code>steer.db</code> 파일이 크다면 <code>VACUUM</code> 실행</li>
    <li><strong>Collector 간격 조정:</strong> <code>STEER_COLLECTOR_INTERVAL</code> 환경변수로 수집 빈도 변경</li>
  </ul>

  <h3>Webhook 전송이 실패합니다</h3>
  <p>실패한 Webhook은 지수 백오프(exponential backoff) 방식으로 최대 5회 재시도됩니다. 5회 실패 후에도 전송되지 않으면:</p>
  <ul>
    <li>대상 URL이 접근 가능한지 확인</li>
    <li>HTTPS 인증서가 유효한지 확인</li>
    <li>방화벽에서 NOVA의 IP를 허용했는지 확인</li>
    <li>응답 시간이 30초 이내인지 확인 (타임아웃)</li>
  </ul>

  <hr />

  <p>해결되지 않는 문제가 있나요? <a href="https://github.com/NOVA-ALLRounder/main/issues">GitHub Issues</a>에서 이슈를 등록하거나 <a href={withBase('/contact')}>팀에 직접 문의</a>하세요.</p>
</DocsLayout>
