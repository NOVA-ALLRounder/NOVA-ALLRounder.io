---
import DocsLayout from '../../layouts/DocsLayout.astro';
const repo = process.env.GITHUB_REPOSITORY?.split('/')[1] ?? '';
const isUserSiteRepo = repo.endsWith('.github.io');
const basePath = process.env.GITHUB_ACTIONS === 'true'
  ? (isUserSiteRepo ? '/' : `/${repo}/`)
  : '/';
const withBase = (url: string) => {
  if (!url.startsWith('/')) return url;
  const clean = url.replace(/^\/+/, '');
  return clean ? `${basePath}${clean}` : basePath;
};
---

<DocsLayout title="고객 대상 시작 가이드" description="NOVA 에이전트 설치, OpenAI API 설정, 첫 번째 surf 명령 실행 가이드." lang="ko">
  <h1>Getting Started</h1>
  <p class="doc-subtitle">NOVA Local OS Agent의 설치, 구성, 실행 전 과정을 안내합니다. 예상 소요 시간은 약 <strong>5분</strong>입니다.</p>

  <!-- OS Switcher -->
  <div class="os-switcher-container" id="os-switcher">
    <button class="os-tab active" data-os-target="macos">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
        <path d="M17.05,20.28c-0.96,0.95-2.05,1.72-3.11,1.72s-1.45-0.67-2.73-0.67c-1.29,0-1.87,0.67-2.9,0.67c-1.03,0-2.14-0.81-3.23-1.89 c-1.95-1.93-3.05-4.88-3.05-7.38c0-2.5,1.13-4.63,2.94-5.75c0.91-0.57,2.05-0.91,3.22-0.91c1.29,0,1.96,0.42,3.23,0.42 c1.26,0,1.87-0.42,3.23-0.42c1.07,0,2.1,0.35,3,0.91c-0.48,0.31-1.39,1.12-1.39,2.68c0,1.72,1.35,2.77,2.37,3.31 c-0.74,1.8-1.5,4.01-2.31,5.32L17.05,20.28z M14.19,3.77c0-1.95,1.4-3.56,3.31-3.77c0.23,2.16-1.5,4.2-3.37,4.2 C14.04,4.2,14.19,3.85,14.19,3.77z"/>
      </svg>
      macOS
    </button>
    <button class="os-tab" data-os-target="windows">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
        <path d="M0,3.449L9.75,2.1L9.75,11.55L0,11.55ZM0,12.45L9.75,12.45L9.75,21.9L0,20.55ZM10.65,1.95L24,0L24,11.55L10.65,11.55ZM10.65,12.45L24,12.45L24,24L10.65,22.05Z"/>
      </svg>
      Windows
    </button>
  </div>

  <div class="doc-callout">
    <strong>이 가이드에서 다루는 내용:</strong> 환경 준비 → 설치 및 빌드 → 에이전트 실행 → 핵심 명령어 사용 → 워크플로우 확장
  </div>

  <div data-os-only="macos">
    <h2>사전 요구사항 (macOS)</h2>
    <p>macOS에서 시작하기 전에 다음 환경이 준비되어 있는지 확인하십시오.</p>
    <table>
      <thead>
        <tr><th>항목</th><th>요구사항</th><th>비고</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>운영체제</strong></td><td>macOS 12+ (Monterey) 이상</td><td>-</td></tr>
        <tr><td><strong>Rust</strong></td><td>1.70 이상</td><td><a href="https://rustup.rs">rustup.rs</a>에서 설치</td></tr>
        <tr><td><strong>Build Tools</strong></td><td>Xcode Command Line Tools</td><td><code>xcode-select --install</code></td></tr>
        <tr><td><strong>OpenAI API Key</strong></td><td>GPT-4 또는 GPT-3.5</td><td>LLM 분석 모듈에 필요</td></tr>
        <tr><td><strong>Git</strong></td><td>최신 버전</td><td>저장소 클론용</td></tr>
      </tbody>
    </table>
  </div>

  <div data-os-only="windows">
    <h2>사전 요구사항 (Windows)</h2>
    <p>Windows에서 시작하기 전에 다음 환경이 준비되어 있는지 확인하십시오.</p>
    <table>
      <thead>
        <tr><th>항목</th><th>요구사항</th><th>비고</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>운영체제</strong></td><td>Windows 10 / 11</td><td>64비트 권장</td></tr>
        <tr><td><strong>Rust</strong></td><td>1.70 이상 (msvc 툴체인)</td><td><a href="https://rustup.rs">rustup.rs</a>에서 설치</td></tr>
        <tr><td><strong>Build Tools</strong></td><td>Visual Studio Build Tools</td><td>C++ 연크릿 도구 포함</td></tr>
        <tr><td><strong>OpenAI API Key</strong></td><td>GPT-4 또는 GPT-3.5</td><td>LLM 분석 모듈에 필요</td></tr>
        <tr><td><strong>Git</strong></td><td>최신 버전</td><td>저장소 클론용</td></tr>
      </tbody>
    </table>
  </div>

  <div class="doc-callout doc-callout-warning" data-os-only="macos">
    <strong>macOS 사용자 주의:</strong> 시스템 환경설정 → 개인정보 보호 및 보안 → 손쉬운 사용에서 터미널 앱에 권한을 부여해야 합니다. 이 권한이 없으면 OS 센서 데이터를 수집할 수 없습니다.
  </div>

  <div class="doc-callout doc-callout-info" data-os-only="windows">
    <strong>Windows 사용자 주의:</strong> PowerShell 실행 정책이 `RemoteSigned`로 설정되어 있어야 합니다. 관리자 권한으로 `Set-ExecutionPolicy RemoteSigned` 명령을 실행하세요.
  </div>

  <h2>Step 1 — 저장소 클론 및 환경 설정</h2>

  <p>GitHub에서 NOVA 저장소를 클론하고 환경변수를 구성합니다.</p>

  <div data-os-only="macos">
    <pre><code>{`# 저장소 클론
git clone https://github.com/NOVA-ALLRounder/main.git
cd main/core

# 환경변수 파일 생성
cp .env.example .env`}</code></pre>
  </div>

  <div data-os-only="windows">
    <pre><code>{`# 저장소 클론
git clone https://github.com/NOVA-ALLRounder/main.git
cd main/core

# 환경변수 파일 생성 (PowerShell)
Copy-Item .env.example .env`}</code></pre>
  </div>

  <p><code>.env</code> 파일을 편집하여 <code>OPENAI_API_KEY</code>를 설정합니다.</p>

  <div class="doc-callout doc-callout-info">
    <strong>참고:</strong> API Key는 <a href="https://platform.openai.com/api-keys">OpenAI 대시보드</a>에서 발급받을 수 있습니다.
  </div>

  <h2>Step 2 — 빌드</h2>

  <p>Rust 네이티브 바이너리를 빌드합니다. Release 빌드는 약 2~3분이 소요됩니다.</p>

  <pre><code>{`cargo build --release`}</code></pre>

  <div data-os-only="macos">
    <p>빌드 완료 후 바이너리 위치: <code>./target/release/local_os_agent</code></p>
  </div>

  <div data-os-only="windows">
    <p>빌드 완료 후 바이너리 위치: <code>.\target\release\local_os_agent.exe</code></p>
  </div>

  <h2>Step 3 — 에이전트 실행</h2>

  <div data-os-only="macos">
    <h3>macOS 실행</h3>
    <pre><code>{`# 퀵 스타트 스크립트 실행 (권장)
    bash scripts/run_local.sh
    
    # 또는 바이너리 직접 실행
    ./target/release/local_os_agent
    
    # 또는 cargo run 사용
    cargo run --release --bin local_os_agent`}</code></pre>
  </div>

  <div data-os-only="windows">
    <h3>Windows 실행</h3>
    <p>Windows 환경에서는 PowerShell 스크립트를 사용합니다:</p>
    <pre><code>{`# PowerShell 스크립트 실행 (권장)
.\scripts\run_core.ps1 -CollectorImpl rust

# 또는 직접 실행
.\target\release\local_os_agent.exe`}</code></pre>
  </div>

  <p>정상적으로 실행되면 다음과 같은 프롬프트가 표시됩니다:</p>

  <pre><code>{`NOVA Agent v2.4.0 ready
Environment Scan: Found 349 apps
Collector: running on port 8080
Write Lock: enabled (use 'unlock' to disable)
Type 'help' for available commands.

>`}</code></pre>

  <h2>Step 4 — 핵심 명령어</h2>

  <p>에이전트가 실행된 상태에서 다음 명령어를 사용할 수 있습니다.</p>

  <table>
    <thead>
      <tr><th>명령어</th><th>설명</th><th>사용 예시</th></tr>
    </thead>
    <tbody>
      <tr><td><code>surf</code></td><td>자연어로 OS 전체 제어 (핵심)</td><td><code>surf "Safari 열어서 날씨 검색해"</code></td></tr>
      <tr><td><code>routine</code></td><td>반복 패턴 분석 결과 조회</td><td><code>routine</code></td></tr>
      <tr><td><code>recommend</code></td><td>AI 기반 자동화 추천</td><td><code>recommend</code></td></tr>
      <tr><td><code>status</code></td><td>시스템 상태 확인</td><td><code>status</code></td></tr>
      <tr><td><code>control</code></td><td>애플리케이션 제어</td><td><code>control Safari open</code></td></tr>
      <tr><td><code>exec</code></td><td>셸 명령 실행 (보안 정책 적용)</td><td><code>exec "echo hello"</code></td></tr>
      <tr><td><code>build_workflow</code></td><td>자연어 기반 워크플로우 생성</td><td><code>build_workflow "매일 9시 Slack 알림"</code></td></tr>
    </tbody>
  </table>

  <h3>패턴 분석 및 자동화 추천</h3>

  <p><code>routine</code> 명령어로 수집된 사용 패턴을 확인하고, <code>recommend</code>로 AI 기반 자동화를 추천받을 수 있습니다:</p>

  <pre><code>{`> routine

분석된 반복 패턴 (최근 7일):
  1. VS Code → Terminal → git commit  (매일 3회)
  2. Slack → Chrome → Google Docs     (매일 5회)
  3. Finder → Terminal → npm run dev   (매일 4회)

> recommend

추천 자동화 3건:
  → git auto-commit 워크플로우 생성
  → 문서 리뷰 알림 자동화
  → dev server 원클릭 실행`}</code></pre>

  <h3>자연어 워크플로우 생성</h3>

  <p><code>build_workflow</code> 명령어는 자연어 프롬프트를 n8n 호환 워크플로우로 변환합니다:</p>

  <pre><code>{`> build_workflow "매일 아침 9시에 Slack 채널에 일간 리포트 전송"

LLM 분석 중...
n8n 워크플로우 생성 중...
workflow_daily_report.json 생성 완료

워크플로우가 n8n에 등록되었습니다.
Dashboard: http://localhost:5678`}</code></pre>

  <h2>Step 5 — 워크플로우 확장 (선택 사항)</h2>

  <h3>n8n 워크플로우 오케스트레이션</h3>

  <p>n8n을 연동하면 복잡한 멀티스텝 워크플로우를 시각적 인터페이스로 관리할 수 있습니다.</p>

  <pre><code>{`# Docker로 n8n 실행
docker compose up -d n8n

# n8n 대시보드 접속
# → http://localhost:5678

# 런타임 모드 변경 (환경변수)
# STEER_N8N_RUNTIME=docker  (기본값)
# STEER_N8N_RUNTIME=npx
# STEER_N8N_RUNTIME=manual`}</code></pre>

  <h3>데이터 수집 및 배치 분석</h3>

  <p>Rust Collector로 OS 센서 데이터를 수집하고, 배치 파이프라인으로 분석합니다:</p>

  <pre><code>{`# 통합 로컬 실행 (권장)
bash scripts/run_local.sh

# Collector 단독 실행
cargo build --manifest-path core/Cargo.toml --bin collector_rs
STEER_DB_PATH=./steer.db ./core/target/debug/collector_rs

# 배치 분석 파이프라인
bash scripts/run_pipeline_rs.sh configs/config.yaml`}</code></pre>

  <h3>데스크톱 앱 빌드 (Tauri)</h3>

  <p>팀 배포용 데스크톱 애플리케이션을 빌드할 수 있습니다.</p>

  <pre><code>{`./scripts/build_release.sh`}</code></pre>

  <div data-os-only="macos">
    <p>빌드 완료 후 <code>.app</code> 파일이 <code>desktop/src-tauri/target/release/bundle/macos/</code>에 생성됩니다.</p>
  </div>

  <div data-os-only="windows">
    <p>빌드 완료 후 <code>.exe</code> 설치 파일이 <code>desktop/src-tauri/target/release/bundle/msi/</code> 또는 <code>nsis/</code>에 생성됩니다.</p>
  </div>

  <h2>다음 단계</h2>

  <p>첫 번째 자동화 실행을 완료했습니다. 다음 문서를 통해 서비스를 심층적으로 활용할 수 있습니다:</p>

  <ul>
    <li><a href={withBase('/docs/tutorials')}>Tutorials</a> — 이메일 자동 분류, 주간 리포트 생성 등 실전 시나리오 가이드</li>
    <li><a href={withBase('/docs/api')}>API Reference</a> — REST API를 활용한 프로그래밍 방식의 자동화 관리</li>
    <li><a href={withBase('/docs/faq')}>FAQ</a> — 자주 묻는 질문과 트러블슈팅</li>
  </ul>

  <hr />
  <p>문제가 발생한 경우 <a href="https://github.com/NOVA-ALLRounder/main/issues">GitHub Issues</a>에서 도움을 받거나 <a href={withBase('/contact')}>기술팀에 직접 문의</a>하실 수 있습니다.</p>

  <style>
    .os-switcher-container {
      display: flex;
      gap: 0.5rem;
      padding: 0.25rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 0.5rem;
      margin: 2rem 0;
      width: fit-content;
    }
    .os-tab {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border: none;
      background: transparent;
      color: #8b8e94;
      font-size: 0.8125rem;
      font-weight: 500;
      cursor: pointer;
      border-radius: 0.375rem;
      transition: all 0.2s;
    }
    .os-tab:hover {
      color: #eeede8;
      background: rgba(255, 255, 255, 0.05);
    }
    .os-tab.active {
      color: #111214;
      background: var(--site-accent);
    }
    [data-os-only] {
      transition: opacity 0.3s, transform 0.3s;
    }
    .os-hidden {
      display: none !important;
    }
  </style>

  <script>
    function updateOS(os) {
      // Update tabs UI
      document.querySelectorAll('.os-tab').forEach(tab => {
        if (tab.dataset.osTarget === os) {
          tab.classList.add('active');
        } else {
          tab.classList.remove('active');
        }
      });

      // Update content visibility
      document.querySelectorAll('[data-os-only]').forEach(el => {
        if (el.dataset.osOnly === os) {
          el.classList.remove('os-hidden');
        } else {
          el.classList.add('os-hidden');
        }
      });

      // Persist
      localStorage.setItem('nova-os-preference', os);
    }

    // Initialize
    const urlParams = new URLSearchParams(window.location.search);
    let preferredOS = urlParams.get('os');

    if (!preferredOS) {
      preferredOS = localStorage.getItem('nova-os-preference');
    }

    if (!preferredOS) {
      // Auto-detect if possible
      const platform = window.navigator.platform.toLowerCase();
      if (platform.includes('mac')) preferredOS = 'macos';
      else if (platform.includes('win')) preferredOS = 'windows';
      else preferredOS = 'macos'; // Default
    }

    updateOS(preferredOS);

    // Event listeners
    document.querySelectorAll('.os-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        updateOS(tab.dataset.osTarget);
      });
    });
  </script>
</DocsLayout>
