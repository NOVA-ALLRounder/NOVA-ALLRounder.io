---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Section from '../components/ui/Section.astro';
import Container from '../components/ui/Container.astro';
import Button from '../components/ui/Button.astro';
import Table from '../components/ui/Table.astro';
import Accordion from '../components/ui/Accordion.astro';

const pricingFaq = [
  {
    question: '무료 플랜으로 무엇을 할 수 있나요?',
    answer: 'Free 플랜으로 코어 기능을 체험하고, 기본 자동화를 실행할 수 있습니다. 사용량 제한이 있으며 커뮤니티 지원이 제공됩니다.',
  },
  {
    question: 'Pro와 Team의 차이는 뭔가요?',
    answer: 'Pro는 개인 파워유저를 위한 플랜이고, Team은 다수의 멤버가 협업하는 팀을 위한 플랜입니다. Team부터 워크플로우 공유, 역할 관리, 시트 기반 과금이 적용됩니다.',
  },
  {
    question: '월간/연간 결제를 변경할 수 있나요?',
    answer: '네. 계정 설정 → 워크스페이스에서 결제 주기를 언제든 변경할 수 있습니다.',
  },
  {
    question: 'Enterprise는 어떻게 시작하나요?',
    answer: '영업 문의를 통해 조달, 보안 검토, PoC, 롤아웃 일정을 조율합니다.',
  },
  {
    question: '환불이 가능한가요?',
    answer: '환불 및 취소 정책은 정식 출시 전 확정될 예정입니다.',
  },
  {
    question: 'B2B 구매자에게 PoC가 가능한가요?',
    answer: '네. Enterprise 플로우에는 계약 전 PoC 단계가 포함됩니다.',
  },
  {
    question: '세금계산서 발행이 가능한가요?',
    answer: 'Enterprise 결제는 세금계산서 발행 및 맞춤 계약 조건을 지원합니다.',
  },
  {
    question: '업그레이드 시 기존 데이터는 어떻게 되나요?',
    answer: '모든 데이터와 설정은 유지됩니다. 업그레이드 즉시 상위 플랜 기능이 활성화됩니다.',
  },
];

const plans = [
  {
    name: 'Free',
    desc: '개인 사용자를 위한 무료 시작',
    price: '₩0',
    period: '/월',
    cta: '무료 시작',
    ctaVariant: 'secondary' as const,
    ctaHref: '/docs/getting-started',
    features: [
      '월 50K 토큰',
      '3개 연동',
      '기본 분석 대시보드',
      '커뮤니티 지원',
      '7일 사용 이력',
    ],
    highlighted: false,
  },
  {
    name: 'Pro',
    desc: '개인 파워유저를 위한 풀 기능',
    price: '$20',
    period: '/월',
    cta: '14일 무료 체험',
    ctaVariant: 'primary' as const,
    ctaHref: '/docs/getting-started',
    features: [
      '월 1M 토큰',
      '무제한 연동',
      '고급 분석 & 리포트',
      '우선 이메일 지원',
      '30일 사용 이력',
      'API 접근',
      '커스텀 웹훅',
    ],
    highlighted: true,
  },
  {
    name: 'Team',
    desc: '협업이 필요한 팀을 위한 플랜',
    price: '$200',
    period: '/시트/월',
    cta: '14일 무료 체험',
    ctaVariant: 'secondary' as const,
    ctaHref: '/docs/getting-started',
    features: [
      '월 10M 토큰',
      'Pro 전체 기능 포함',
      '워크플로우 공유 & 협업',
      '팀 역할 관리',
      '90일 사용 이력',
      '팀 분석 대시보드',
      'Slack / Teams 알림',
    ],
    highlighted: false,
  },
  {
    name: 'Enterprise',
    desc: '고급 거버넌스가 필요한 조직',
    price: '맞춤',
    period: '',
    cta: '영업 문의',
    ctaVariant: 'secondary' as const,
    ctaHref: '/contact',
    features: [
      '무제한 토큰',
      'Team 전체 기능 포함',
      'SSO 및 RBAC',
      '감사 로그 & 컴플라이언스',
      '전담 지원 매니저',
      '맞춤 연동 개발',
      'SLA 계약',
      '온프레미스 옵션',
    ],
    highlighted: false,
  },
];

const comparisonFeatures = [
  { name: '월간 토큰', free: '50K', pro: '1M', team: '10M', enterprise: '무제한' },
  { name: '연동', free: '3개', pro: '무제한', team: '무제한', enterprise: '무제한 + 맞춤' },
  { name: '시트', free: '1', pro: '1', team: '무제한', enterprise: '무제한' },
  { name: '분석', free: '기본', pro: '고급', team: '팀 대시보드', enterprise: '맞춤' },
  { name: 'API 접근', free: '—', pro: '✓', team: '✓', enterprise: '✓' },
  { name: '커스텀 웹훅', free: '—', pro: '✓', team: '✓', enterprise: '✓' },
  { name: '워크플로우 공유', free: '—', pro: '—', team: '✓', enterprise: '✓' },
  { name: '팀 역할 관리', free: '—', pro: '—', team: '✓', enterprise: '고급' },
  { name: 'SSO', free: '—', pro: '—', team: '—', enterprise: '✓' },
  { name: 'RBAC', free: '—', pro: '—', team: '기본', enterprise: '고급' },
  { name: '감사 로그', free: '—', pro: '—', team: '—', enterprise: '✓' },
  { name: '사용 이력 보관', free: '7일', pro: '30일', team: '90일', enterprise: '맞춤' },
  { name: '지원', free: '커뮤니티', pro: '이메일', team: '이메일/채팅', enterprise: '전담 매니저' },
  { name: 'SLA', free: '—', pro: '99.5%', team: '99.9%', enterprise: '99.99%' },
];
---

<BaseLayout title="요금제 - AllvIa" description="Free, Pro, Team, Enterprise — 사용 규모에 맞는 플랜을 선택하세요." lang="ko">
  <Header slot="header" lang="ko" />

  <Section padding="large">
    <Container>
      <div class="text-center max-w-4xl mx-auto animate-on-scroll">
        <p class="text-caption text-[#a5b4fc] font-medium tracking-wide uppercase mb-4">Pricing</p>
        <h1 class="text-h1 md:text-display text-neutral-100 mb-6 text-balance">무료로 시작하고, 필요에 따라 확장하세요</h1>
        <p class="text-body-lg text-neutral-400 max-w-2xl mx-auto">
          개인 체험부터 엔터프라이즈 도입까지, 규모에 맞는 플랜을 선택하세요.
        </p>
      </div>
    </Container>
  </Section>

  <Section padding="none" class="pb-24 md:pb-32">
    <Container>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 animate-on-scroll">
        {plans.map((plan) => (
          <div class:list={[
            'rounded-lg border p-8 flex flex-col',
            plan.highlighted
              ? 'border-[#a5b4fc] bg-[#a5b4fc]/10 shadow-lg shadow-[#00000040] relative'
              : 'border-white/10 bg-[#14161b]',
          ]}>
            {plan.highlighted && (
              <span class="absolute -top-3 left-1/2 -translate-x-1/2 inline-flex items-center px-3 py-1 rounded-full bg-[#a5b4fc] text-[#111214] text-xs font-medium">
                가장 인기
              </span>
            )}
            <h3 class="text-h3 text-neutral-100 mb-1">{plan.name}</h3>
            <p class="text-caption text-neutral-400 mb-6">{plan.desc}</p>
            <div class="mb-6">
              <span class="text-h1 text-neutral-100">{plan.price}</span>
              {plan.period && <span class="text-body text-neutral-400 ml-1">{plan.period}</span>}
            </div>
            <Button
              variant={plan.ctaVariant}
              size="md"
              href={plan.ctaHref}
              class="w-full mb-8"
            >
              {plan.cta}
            </Button>
            <ul class="space-y-3 flex-1">
              {plan.features.map((feature) => (
                <li class="flex items-start gap-3 text-sm text-neutral-300">
                  <svg class="w-4 h-4 text-[#a5b4fc] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                  <span>{feature}</span>
                </li>
              ))}
            </ul>
          </div>
        ))}
      </div>
    </Container>
  </Section>

  <Section background="light">
    <Container>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-100 mb-4">기능 비교</h2>
          <p class="text-body-lg text-neutral-400">플랜별 기능을 한눈에 비교하세요.</p>
        </div>
        <div class="overflow-x-auto">
          <Table>
            <thead>
              <tr>
                <th>기능</th>
                <th>Free</th>
                <th>Pro</th>
                <th>Team</th>
                <th>Enterprise</th>
              </tr>
            </thead>
            <tbody>
              {comparisonFeatures.map((f) => (
                <tr>
                  <td class="font-medium text-neutral-100">{f.name}</td>
                  <td>{f.free}</td>
                  <td>{f.pro}</td>
                  <td>{f.team}</td>
                  <td>{f.enterprise}</td>
                </tr>
              ))}
            </tbody>
          </Table>
        </div>
      </div>
    </Container>
  </Section>

  <Section>
    <Container narrow>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-100 mb-4">B2B 구매 프로세스</h2>
          <p class="text-body-lg text-neutral-400">엔터프라이즈 조달을 위한 체계적인 프로세스.</p>
        </div>
        <div class="space-y-4">
          {[
            { step: '1', title: '범위 확인 & 견적', desc: '팀 규모, 목표, 법무/조달 요구사항을 정리합니다.' },
            { step: '2', title: 'PoC 검증', desc: '범위를 한정하여 적합성, 안정성, 워크플로우를 검증합니다.' },
            { step: '3', title: '계약 & 결제', desc: '상업 조건을 확정하고 세금계산서 또는 카드 결제 경로를 설정합니다.' },
            { step: '4', title: '롤아웃 & 지원', desc: '팀을 온보딩하고 단계적 거버넌스 체크포인트로 도입을 모니터링합니다.' },
          ].map((item) => (
            <div class="flex gap-4 p-5 bg-[#14161b] rounded-lg border border-white/10">
              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-white/10 text-neutral-100 text-sm font-bold flex-shrink-0">{item.step}</span>
              <div>
                <h3 class="text-h4 text-neutral-100 mb-1">{item.title}</h3>
                <p class="text-caption text-neutral-400">{item.desc}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </Container>
  </Section>

  <Section background="light">
    <Container narrow>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-100 mb-4">요금제 FAQ</h2>
          <p class="text-body-lg text-neutral-400">요금제 및 결제에 관한 자주 묻는 질문.</p>
        </div>
        <Accordion items={pricingFaq} />
      </div>
    </Container>
  </Section>

  <Section background="dark">
    <Container>
      <div class="text-center animate-on-scroll">
        <h2 class="text-h2 text-white mb-4">어떤 플랜이 맞을지 고민되시나요?</h2>
        <p class="text-body-lg text-neutral-400 max-w-xl mx-auto mb-10">
          무료로 바로 시작하거나, 영업팀에 문의해 맞춤 플랜을 안내받으세요.
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <Button variant="primary" size="lg" href="/docs/getting-started">무료로 시작</Button>
          <Button variant="ghost" size="lg" href="/contact">영업 문의</Button>
        </div>
      </div>
    </Container>
  </Section>

  <Footer slot="footer" />
</BaseLayout>
