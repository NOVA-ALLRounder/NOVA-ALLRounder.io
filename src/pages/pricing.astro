---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Section from '../components/ui/Section.astro';
import Container from '../components/ui/Container.astro';
import Button from '../components/ui/Button.astro';
import Table from '../components/ui/Table.astro';
import Accordion from '../components/ui/Accordion.astro';

const pricingFaq = [
  { question: '무료 플랜에 제한이 있나요?', answer: '핵심 기능은 모두 사용할 수 있습니다. 월 1,000건 자동화 실행, 커넥터 5개, 단일 사용자로 제한됩니다.' },
  { question: '결제 주기를 변경할 수 있나요?', answer: '네, 언제든 월간 ↔ 연간 전환이 가능합니다. 연간 결제 시 20% 할인이 적용됩니다.' },
  { question: '팀 인원 추가 비용은?', answer: 'Team 플랜은 사용자당 과금됩니다. 10명 이상 시 볼륨 할인이 자동 적용됩니다.' },
  { question: 'Enterprise 플랜은 어떻게 시작하나요?', answer: '영업팀에 문의하시면, 조직 규모와 요구사항에 맞춘 맞춤 제안을 받으실 수 있습니다.' },
  { question: '환불 정책이 있나요?', answer: '유료 플랜 전환 후 14일 이내 요청 시 전액 환불됩니다. 연간 결제도 동일합니다.' },
  { question: 'PoC 기간에 비용이 발생하나요?', answer: '아니요, Enterprise PoC는 2주간 무료로 진행됩니다. 본 계약은 검증 후 결정합니다.' },
  { question: '청구서 발행이 가능한가요?', answer: 'Enterprise 플랜에서 세금계산서 및 청구서 발행을 지원합니다. 결제 조건도 협의 가능합니다.' },
  { question: '데이터는 어디에 저장되나요?', answer: '기본적으로 글로벌 리전에 저장되며, Enterprise 플랜에서는 한국(서울) 리전을 선택할 수 있습니다.' },
];

const plans = [
  {
    name: 'Individual',
    desc: '개인 사용자를 위한 무료 플랜',
    price: '₩0',
    period: '/월',
    cta: '무료로 시작',
    ctaVariant: 'secondary' as const,
    features: ['월 1,000건 자동화 실행', '커넥터 5개', '기본 대시보드', '커뮤니티 지원', '7일 실행 이력'],
    highlighted: false,
  },
  {
    name: 'Team',
    desc: '성장하는 팀을 위한 플랜',
    price: '₩49,000',
    period: '/사용자/월',
    cta: '14일 무료 체험',
    ctaVariant: 'primary' as const,
    features: ['월 50,000건 자동화 실행', '커넥터 무제한', '고급 대시보드 & 리포트', '이메일 + 채팅 지원', '90일 실행 이력', '팀 공유 워크플로우', 'API 접근'],
    highlighted: true,
  },
  {
    name: 'Enterprise',
    desc: '대규모 조직을 위한 맞춤 플랜',
    price: '맞춤 견적',
    period: '',
    cta: '영업팀 문의',
    ctaVariant: 'secondary' as const,
    features: ['무제한 자동화 실행', '모든 Team 기능 포함', 'SSO & RBAC', '감사 로그 & 컴플라이언스', '전용 인프라 옵션', '전담 CSM & SLA', '온보딩 프로그램', '커스텀 연동'],
    highlighted: false,
  },
];

const comparisonFeatures = [
  { name: '자동화 실행', individual: '1,000/월', team: '50,000/월', enterprise: '무제한' },
  { name: '커넥터', individual: '5개', team: '무제한', enterprise: '무제한 + 커스텀' },
  { name: '사용자', individual: '1명', team: '무제한', enterprise: '무제한' },
  { name: 'AI 기능', individual: '기본', team: '고급', enterprise: '전체 + 커스텀 모델' },
  { name: '대시보드', individual: '기본', team: '고급', enterprise: '맞춤 구성' },
  { name: 'API 접근', individual: '—', team: '✓', enterprise: '✓' },
  { name: 'SSO', individual: '—', team: '—', enterprise: '✓' },
  { name: 'RBAC', individual: '—', team: '기본', enterprise: '고급' },
  { name: '감사 로그', individual: '—', team: '—', enterprise: '✓' },
  { name: '실행 이력 보관', individual: '7일', team: '90일', enterprise: '무제한' },
  { name: '지원', individual: '커뮤니티', team: '이메일 + 채팅', enterprise: '전담 + SLA' },
  { name: 'SLA', individual: '—', team: '99.9%', enterprise: '99.99%' },
];
---

<BaseLayout title="Pricing — NOVA" description="개인부터 엔터프라이즈까지, 팀 규모에 맞는 요금제를 선택하세요.">
  <Header slot="header" />

  <!-- Hero -->
  <Section padding="large">
    <Container>
      <div class="text-center max-w-4xl mx-auto animate-on-scroll">
        <p class="text-caption text-accent-600 font-medium tracking-wide uppercase mb-4">Pricing</p>
        <h1 class="text-h1 md:text-display text-neutral-900 mb-6 text-balance">
          필요한 만큼만,<br class="hidden md:block" /> 합리적으로
        </h1>
        <p class="text-body-lg text-neutral-500 max-w-2xl mx-auto">
          무료로 시작하고, 팀의 성장에 맞춰 확장하세요. 숨은 비용 없이 투명하게 운영됩니다.
        </p>
      </div>
    </Container>
  </Section>

  <!-- Plan Cards -->
  <Section padding="none" class="pb-24 md:pb-32">
    <Container>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 animate-on-scroll">
        {plans.map((plan) => (
          <div class:list={[
            'rounded-2xl border p-8 flex flex-col',
            plan.highlighted
              ? 'border-accent-500 bg-accent-50/30 shadow-lg shadow-accent-500/10 relative'
              : 'border-neutral-200 bg-white',
          ]}>
            {plan.highlighted && (
              <span class="absolute -top-3 left-1/2 -translate-x-1/2 inline-flex items-center px-3 py-1 rounded-full bg-accent-600 text-white text-xs font-medium">
                가장 인기
              </span>
            )}
            <h3 class="text-h3 text-neutral-900 mb-1">{plan.name}</h3>
            <p class="text-caption text-neutral-500 mb-6">{plan.desc}</p>
            <div class="mb-6">
              <span class="text-h1 text-neutral-900">{plan.price}</span>
              {plan.period && <span class="text-body text-neutral-400 ml-1">{plan.period}</span>}
            </div>
            <Button
              variant={plan.ctaVariant}
              size="md"
              href={plan.ctaVariant === 'primary' ? '/docs/getting-started' : '/company#contact'}
              class="w-full mb-8"
            >
              {plan.cta}
            </Button>
            <ul class="space-y-3 flex-1">
              {plan.features.map((feature) => (
                <li class="flex items-start gap-3 text-sm text-neutral-600">
                  <svg class="w-4 h-4 text-accent-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                  <span>{feature}</span>
                </li>
              ))}
            </ul>
          </div>
        ))}
      </div>
    </Container>
  </Section>

  <!-- Feature Comparison Table -->
  <Section background="light">
    <Container>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-900 mb-4">플랜별 상세 비교</h2>
          <p class="text-body-lg text-neutral-500">각 플랜에 포함된 기능을 비교해 보세요.</p>
        </div>
        <Table>
          <thead>
            <tr>
              <th>기능</th>
              <th>Individual</th>
              <th>Team</th>
              <th>Enterprise</th>
            </tr>
          </thead>
          <tbody>
            {comparisonFeatures.map((f) => (
              <tr>
                <td class="font-medium text-neutral-900">{f.name}</td>
                <td>{f.individual}</td>
                <td>{f.team}</td>
                <td>{f.enterprise}</td>
              </tr>
            ))}
          </tbody>
        </Table>
      </div>
    </Container>
  </Section>

  <!-- B2B Purchase Flow -->
  <Section>
    <Container narrow>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-900 mb-4">기업 구매 안내</h2>
          <p class="text-body-lg text-neutral-500">대규모 도입 시 다음 절차로 진행됩니다.</p>
        </div>
        <div class="space-y-4">
          {[
            { step: '1', title: '상담 · 견적', desc: '영업팀과 조직 규모, 요구사항을 논의하고 맞춤 견적을 받습니다.' },
            { step: '2', title: 'PoC · 검증', desc: '2주간 무료 파일럿을 통해 실제 환경에서 효과를 검증합니다.' },
            { step: '3', title: '계약 · 구매', desc: '계약 조건 협의 후 세금계산서 기반으로 결제합니다. 연간/다년 계약 가능.' },
            { step: '4', title: '온보딩 · 운영', desc: '전담 CSM이 온보딩을 진행하고, 지속적인 기술 지원을 제공합니다.' },
          ].map((item) => (
            <div class="flex gap-4 p-5 bg-neutral-50 rounded-xl border border-neutral-200">
              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-neutral-900 text-white text-sm font-bold flex-shrink-0">{item.step}</span>
              <div>
                <h3 class="text-h4 text-neutral-900 mb-1">{item.title}</h3>
                <p class="text-caption text-neutral-500">{item.desc}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </Container>
  </Section>

  <!-- FAQ -->
  <Section background="light">
    <Container narrow>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-900 mb-4">요금 관련 FAQ</h2>
          <p class="text-body-lg text-neutral-500">가격과 결제에 관해 가장 많이 묻는 질문입니다.</p>
        </div>
        <Accordion items={pricingFaq} />
      </div>
    </Container>
  </Section>

  <!-- CTA -->
  <Section background="dark">
    <Container>
      <div class="text-center animate-on-scroll">
        <h2 class="text-h2 text-white mb-4">어떤 플랜이 맞을지 모르겠다면</h2>
        <p class="text-body-lg text-neutral-400 max-w-xl mx-auto mb-10">
          무료 플랜으로 먼저 시작하거나, 영업팀에 편하게 문의하세요.
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <Button variant="primary" size="lg" href="/docs/getting-started" class="bg-white text-neutral-900 hover:bg-neutral-100">무료로 시작하기</Button>
          <Button variant="ghost" size="lg" href="/company#contact" class="text-neutral-300 hover:text-white hover:bg-white/10">영업팀에 문의</Button>
        </div>
      </div>
    </Container>
  </Section>

  <Footer slot="footer" />
</BaseLayout>
