---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Section from '../components/ui/Section.astro';
import Container from '../components/ui/Container.astro';
import Button from '../components/ui/Button.astro';
import StepCard from '../components/ui/StepCard.astro';
import Accordion from '../components/ui/Accordion.astro';
import InstallTabsShowcase from '../components/InstallTabsShowcase.astro';
import WorkflowAnimation from '../components/WorkflowAnimation.astro';

const faqItems = [
  {
    question: '어떤 운영체제를 지원하나요?',
    answer:
      'macOS 12+(Monterey)를 기본 지원하며, Windows 10+ 환경에서도 PowerShell 기반 서비스(run_core.ps1)로 실행 가능합니다. Rust 네이티브 빌드이므로 Linux에서도 컴파일할 수 있습니다.',
  },
  {
    question: '자연어로 컴퓨터를 조작할 수 있나요?',
    answer:
      '네. surf 명령어로 "Safari 열어서 구글에 날씨 검색해" 같은 자연어 지시를 입력하면, 의도 분석(intent_router) → 슬롯 추출(slot_filler) → 실행 계획(plan_builder) → 실행(execution_controller) → 검증(verification_engine) 파이프라인이 자동으로 작동합니다.',
  },
  {
    question: 'OpenAI API Key가 반드시 필요한가요?',
    answer:
      '네. LLM 기반 행동 패턴 분석, 자연어 명령 해석, 워크플로우 생성에 OpenAI API를 사용합니다. .env 파일에 OPENAI_API_KEY를 설정해야 합니다. 초기 테스트에는 GPT-3.5로 충분합니다.',
  },
  {
    question: '보안은 어떻게 처리되나요?',
    answer:
      'Zero Trust 원칙을 적용합니다. LLM 출력은 기본적으로 위험하다고 간주하며, 5계층 보안(policy.rs, security.rs, tool_policy.rs, privacy.rs PII 마스킹, send_policy.rs)을 거칩니다. Write Lock이 기본 활성화되어 있고, Critical 등급 행동은 건별 사용자 승인이 필요합니다.',
  },
  {
    question: '어떤 외부 서비스와 연동되나요?',
    answer:
      'Gmail(이메일 조회/발송), Google Calendar(일정 확인), Notion(페이지 읽기/쓰기), Telegram(원격 제어)을 기본 지원합니다. n8n 워크플로우 엔진과 연동하면 수백 개의 추가 서비스를 자동화할 수 있습니다.',
  },
  {
    question: '팀에서 함께 사용할 수 있나요?',
    answer:
      'Tauri 기반 데스크톱 앱(.app/.exe)으로 팀원에게 원클릭 배포 가능합니다. n8n 워크플로우 공유, RBAC 기반 역할 관리, Self-Healing Guardian(프로세스 자동 재시작)을 지원합니다.',
  },
];
---

<BaseLayout title="AllvIa — All works via AI" description="자연어로 컴퓨터를 제어하는 AI 에이전트. 73개+ Rust 모듈, 5계층 보안, 자동 패턴 분석과 워크플로우 생성." lang="ko">
  <Header slot="header" lang="ko" />

  <!-- Hero -->
  <Section padding="large" class="bg-[#0d0e11] text-white">
    <Container>
      <div class="max-w-4xl mx-auto text-center animate-on-scroll">
        <p class="accent-pill mb-4">All works via AI</p>
        <h1 class="text-h1 md:text-display text-white mb-6 text-balance max-w-3xl mx-auto">
          자연어 한 줄로
          <br class="hidden lg:block" />
          컴퓨터를 제어하세요
        </h1>
        <p class="text-body-lg text-neutral-400 max-w-2xl mx-auto mb-10">
          AllvIa는 자연어 명령을 이해하고, OS 수준에서 앱을 조작하며, 
          Shadow Mode를 통해 백그라운드에서 사용 패턴을 학습하여 자동화를 제안하는 Rust 네이티브 AI 에이전트입니다.
        </p>

        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-10">
          <Button variant="primary" size="lg" href="/docs/getting-started?os=macos" class="whitespace-nowrap min-w-[200px]">
            <svg slot="before" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
              <path d="M17.05,20.28c-0.96,0.95-2.05,1.72-3.11,1.72s-1.45-0.67-2.73-0.67c-1.29,0-1.87,0.67-2.9,0.67c-1.03,0-2.14-0.81-3.23-1.89 c-1.95-1.93-3.05-4.88-3.05-7.38c0-2.5,1.13-4.63,2.94-5.75c0.91-0.57,2.05-0.91,3.22-0.91c1.29,0,1.96,0.42,3.23,0.42 c1.26,0,1.87-0.42,3.23-0.42c1.07,0,2.1,0.35,3,0.91c-0.48,0.31-1.39,1.12-1.39,2.68c0,1.72,1.35,2.77,2.37,3.31 c-0.74,1.8-1.5,4.01-2.31,5.32L17.05,20.28z M14.19,3.77c0-1.95,1.4-3.56,3.31-3.77c0.23,2.16-1.5,4.2-3.37,4.2 C14.04,4.2,14.19,3.85,14.19,3.77z"/>
            </svg>
            macOS에서 시작하기
          </Button>
          <Button variant="secondary" size="lg" href="/docs/getting-started?os=windows" class="whitespace-nowrap min-w-[200px]">
            <svg slot="before" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
              <path d="M0,3.449L9.75,2.1L9.75,11.55L0,11.55ZM0,12.45L9.75,12.45L9.75,21.9L0,20.55ZM10.65,1.95L24,0L24,11.55L10.65,11.55ZM10.65,12.45L24,12.45L24,24L10.65,22.05Z"/>
            </svg>
            Windows에서 시작하기
          </Button>
        </div>

        <WorkflowAnimation />
      </div>
    </Container>
  </Section>

  <!-- Install Showcase -->
  <Section class="bg-[#0f1116]">
    <Container>
      <InstallTabsShowcase />
    </Container>
  </Section>

  <!-- Stats & Commands -->
  <Section class="bg-[#0f1116]">
    <Container>
      <div class="animate-on-scroll">
        <p class="text-center text-caption text-neutral-500 font-medium tracking-wide uppercase mb-10">Core Capabilities</p>

        <div class="flex flex-wrap items-center justify-center gap-8 md:gap-14 mb-16">
          {['surf', 'routine', 'recommend', 'control', 'build_workflow', 'exec', 'status'].map((name) => (
            <div class="flex items-center justify-center h-8 px-4 text-neutral-400 text-sm font-mono font-semibold tracking-wider">{name}</div>
          ))}
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-5 max-w-4xl mx-auto">
          {[
            { value: '73+', label: 'Rust 모듈' },
            { value: '5', label: '보안 계층' },
            { value: '4', label: '외부 연동 서비스' },
            { value: '7', label: 'CLI 명령어' },
          ].map((stat) => (
            <div class="text-center rounded-lg border border-white/10 bg-[#14161b] py-8">
              <p class="text-h2 text-white font-bold">{stat.value}</p>
              <p class="text-caption text-neutral-500 mt-1">{stat.label}</p>
            </div>
          ))}
        </div>
      </div>
    </Container>
  </Section>

  <!-- How It Works -->
  <Section>
    <Container>
      <div class="text-center mb-16 animate-on-scroll">
        <h2 class="text-h2 text-neutral-100 mb-4">How It Works</h2>
        <p class="text-body-lg text-neutral-400 max-w-xl mx-auto">자연어 입력부터 OS 제어, 결과 검증까지 자동화된 파이프라인.</p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-12 animate-on-scroll">
        <StepCard step={1} title="Understand" description="intent_router가 자연어를 분석하고, slot_filler가 실행에 필요한 파라미터를 추출합니다." />
        <StepCard step={2} title="Execute" description="plan_builder가 실행 계획을 생성하고, visual_driver와 browser_automation이 OS를 직접 제어합니다." />
        <StepCard step={3} title="Verify" description="verification_engine이 결과를 검증하고, approval_gate가 위험 행동을 사전 차단합니다." />
      </div>
    </Container>
  </Section>

  <!-- Feature 1: NL Control -->
  <Section background="light">
    <Container>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center animate-on-scroll">
        <div>
          <p class="text-caption text-[#a5b4fc] font-medium tracking-wide uppercase mb-3">Natural Language Control</p>
          <h2 class="text-h2 text-neutral-100 mb-6">자연어로 복잡한 멀티앱 시나리오를 실행합니다</h2>
          <p class="text-body-lg text-neutral-400 mb-8">
            "Safari에서 주가 검색 → Calculator로 계산 → Notes에 저장" 같은 복잡한 멀티앱 워크플로우를 한 줄의 자연어로 처리합니다.
          </p>
          <ul class="space-y-3">
            {[
              'surf — 자연어로 OS 전체를 제어하는 핵심 명령어',
              'control — 앱 실행, 전환, 종료를 CLI로 제어',
              'exec — 보안 정책이 적용된 셸 명령 실행',
            ].map((item) => (
              <li class="flex items-start gap-3 text-body text-neutral-300">
                <svg class="w-5 h-5 text-[#a5b4fc] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                <span><code class="text-[#a5b4fc] text-sm">{item.split(' — ')[0]}</code> — {item.split(' — ')[1]}</span>
              </li>
            ))}
          </ul>
        </div>
        <div class="bg-[#14161b] rounded-lg border border-white/10 p-6 font-mono text-sm text-neutral-400">
          <div class="flex items-center gap-2 mb-4 pb-3 border-b border-white/5">
            <span class="w-2.5 h-2.5 rounded-full bg-[#ff5f57]"></span>
            <span class="w-2.5 h-2.5 rounded-full bg-[#febc2e]"></span>
            <span class="w-2.5 h-2.5 rounded-full bg-[#28c840]"></span>
            <span class="ml-2 text-xs text-neutral-600">nova-agent</span>
          </div>
          <p class="text-neutral-500 mb-2">$ cargo run --bin local_os_agent</p>
          <p class="text-[#8fd5a6]">&gt; surf "Safari 열어서 Google에서 Apple stock price 검색해"</p>
          <p class="text-neutral-300 mt-2">Intent: web_search | Slots: {`{app: Safari, query: Apple stock price}`}</p>
          <p class="text-neutral-300">Plan: Open Safari → Navigate → Search → Extract</p>
          <p class="text-[#8fd5a6] mt-1">[OK] Safari 실행 완료 (applescript.rs)</p>
          <p class="text-[#8fd5a6]">[OK] Google 검색 완료 (browser_automation.rs)</p>
          <p class="text-[#8fd5a6]">[OK] 결과 추출 완료 (visual_driver.rs)</p>
          <p class="text-neutral-500 mt-3">&gt; control Notes open</p>
          <p class="text-[#8fd5a6] mt-1">[OK] Notes 실행 완료</p>
        </div>
      </div>
    </Container>
  </Section>

  <!-- Feature 2: Security -->
  <Section>
    <Container>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center animate-on-scroll">
        <div class="order-2 lg:order-1 bg-[#14161b] rounded-lg border border-white/10 p-6 font-mono text-sm text-neutral-400">
          <div class="flex items-center gap-2 mb-4 pb-3 border-b border-white/5">
            <span class="w-2.5 h-2.5 rounded-full bg-[#ff5f57]"></span>
            <span class="w-2.5 h-2.5 rounded-full bg-[#febc2e]"></span>
            <span class="w-2.5 h-2.5 rounded-full bg-[#28c840]"></span>
            <span class="ml-2 text-xs text-neutral-600">nova-agent</span>
          </div>
          <p class="text-[#8fd5a6]">&gt; exec "echo hello world"</p>
          <p class="text-neutral-300 mt-1">[Safe] hello world</p>
          <p class="text-[#8fd5a6] mt-3">&gt; exec "rm -rf /"</p>
          <p class="text-red-400 mt-1">[BLOCKED] security.rs: Critical — 위험 명령어 차단</p>
          <p class="text-[#8fd5a6] mt-3">&gt; exec "sudo apt install"</p>
          <p class="text-red-400 mt-1">[BLOCKED] policy.rs: Caution — Write Lock 활성화 상태</p>
          <p class="text-[#8fd5a6] mt-3">&gt; unlock</p>
          <p class="text-neutral-300 mt-1">[OK] Write Lock 해제 (자동 재잠금: 60초)</p>
          <p class="text-neutral-500 mt-3 text-xs">PII 마스킹 (privacy.rs): user@email.com → [EMAIL_MASKED]</p>
        </div>
        <div class="order-1 lg:order-2">
          <p class="text-caption text-[#a5b4fc] font-medium tracking-wide uppercase mb-3">Zero Trust Security</p>
          <h2 class="text-h2 text-neutral-100 mb-6">LLM 출력을 절대 신뢰하지 않습니다</h2>
          <p class="text-body-lg text-neutral-400 mb-8">
            모든 AI 생성 명령은 실행 전 5계층 보안을 통과해야 합니다. 위험 등급에 따라 자동 승인, Write Lock 해제, 또는 건별 사용자 확인이 필요합니다.
          </p>
          <ul class="space-y-3">
            {[
              'policy.rs — Safe / Caution / Critical 3단계 분류',
              'security.rs — 셸 명령 위험도 자동 분석',
              'privacy.rs — 이메일, 카드번호 등 PII 자동 마스킹',
              'tool_policy.rs — 도구별 Allow/Denylist 관리',
              'Write Lock — 기본 잠금, 시간 제한 자동 재잠금',
            ].map((item) => (
              <li class="flex items-start gap-3 text-body text-neutral-300">
                <svg class="w-5 h-5 text-[#a5b4fc] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                <span><code class="text-[#a5b4fc] text-sm">{item.split(' — ')[0]}</code> — {item.split(' — ')[1]}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </Container>
  </Section>

  <!-- Feature 3: Integrations -->
  <Section background="light">
    <Container>
      <div class="max-w-4xl mx-auto text-center animate-on-scroll">
        <p class="text-caption text-[#a5b4fc] font-medium tracking-wide uppercase mb-3">Integrations & Automation</p>
        <h2 class="text-h2 text-neutral-100 mb-6">외부 서비스와 실시간으로 연동됩니다</h2>
        <p class="text-body-lg text-neutral-400 mb-12 max-w-2xl mx-auto">
          Gmail, Calendar, Notion과 네이티브 통합하고, Telegram으로 외출 중에도 원격 제어하며, n8n으로 수백 개의 서비스를 자동화합니다.
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 text-left">
          {[
            { title: 'Gmail', desc: '이메일 조회, 발송, 분류를 자동으로 처리합니다.', module: 'gmail.rs' },
            { title: 'Calendar', desc: '일정 확인, 생성, 리마인더를 관리합니다.', module: 'calendar.rs' },
            { title: 'Notion', desc: '페이지 읽기/쓰기, 데이터베이스 조회를 지원합니다.', module: 'notion.rs' },
            { title: 'Telegram', desc: '외출 중에도 폰에서 컴퓨터를 원격 제어합니다.', module: 'telegram.rs' },
          ].map((item) => (
            <div class="bg-[#14161b] rounded-lg p-6 border border-white/10">
              <h3 class="text-h4 text-neutral-100 mb-2">{item.title}</h3>
              <p class="text-caption text-neutral-400 mb-3">{item.desc}</p>
              <p class="text-xs text-neutral-600 font-mono">{item.module}</p>
            </div>
          ))}
        </div>
        <div class="mt-8">
          <Button variant="primary" size="lg" href="/solutions">모든 솔루션 보기</Button>
        </div>
      </div>
    </Container>
  </Section>

  <!-- Feature 4: Pattern & Workflow -->
  <Section>
    <Container>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center animate-on-scroll">
        <div>
          <p class="text-caption text-[#a5b4fc] font-medium tracking-wide uppercase mb-3">Shadow Mode & Workflow</p>
          <h2 class="text-h2 text-neutral-100 mb-6">사용 패턴을 학습하고, 워크플로우를 자동 생성합니다</h2>
          <p class="text-body-lg text-neutral-400 mb-8">
            Rust-native Collector가 백그라운드에서 OS 센서 데이터를 수집하고, Shadow Mode가 반복 루틴을 식별하여 최적의 자동화 워크플로우를 제안합니다.
          </p>
          <ul class="space-y-3">
            {[
              'routine — 최근 7일 반복 패턴 자동 분석',
              'recommend — AI 기반 자동화 추천',
              'build_workflow — 자연어 → n8n 워크플로우 변환',
            ].map((item) => (
              <li class="flex items-start gap-3 text-body text-neutral-300">
                <svg class="w-5 h-5 text-[#a5b4fc] flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                <span><code class="text-[#a5b4fc] text-sm">{item.split(' — ')[0]}</code> — {item.split(' — ')[1]}</span>
              </li>
            ))}
          </ul>
        </div>
        <div class="bg-[#14161b] rounded-lg border border-white/10 p-6 font-mono text-sm text-neutral-400">
          <div class="flex items-center gap-2 mb-4 pb-3 border-b border-white/5">
            <span class="w-2.5 h-2.5 rounded-full bg-[#ff5f57]"></span>
            <span class="w-2.5 h-2.5 rounded-full bg-[#febc2e]"></span>
            <span class="w-2.5 h-2.5 rounded-full bg-[#28c840]"></span>
            <span class="ml-2 text-xs text-neutral-600">nova-agent</span>
          </div>
          <p class="text-[#8fd5a6]">&gt; routine</p>
          <p class="text-neutral-300 mt-2">분석된 반복 패턴 (최근 7일):</p>
          <p class="text-neutral-400 ml-4">1. VS Code → Terminal → git commit (매일 3회)</p>
          <p class="text-neutral-400 ml-4">2. Slack → Chrome → Google Docs (매일 5회)</p>
          <p class="text-neutral-400 ml-4">3. Finder → Terminal → npm run dev (매일 4회)</p>
          <p class="text-[#8fd5a6] mt-3">&gt; build_workflow "매주 월요일 9시 KPI 리포트를 Slack으로 전송"</p>
          <p class="text-neutral-300 mt-2">LLM 분석 중...</p>
          <p class="text-neutral-300">n8n 워크플로우 생성:</p>
          <p class="text-neutral-400 ml-4">├─ Trigger: Schedule (월요일 09:00 KST)</p>
          <p class="text-neutral-400 ml-4">├─ Action: Google Sheets → Read KPI</p>
          <p class="text-neutral-400 ml-4">├─ Action: Format → Markdown Report</p>
          <p class="text-neutral-400 ml-4">└─ Action: Slack → #team-weekly</p>
          <p class="text-[#8fd5a6] mt-2">[OK] workflow_weekly_kpi.json 생성 완료</p>
        </div>
      </div>
    </Container>
  </Section>

  <!-- Architecture: Desktop & Web UI -->
  <Section background="light">
    <Container>
      <div class="max-w-4xl mx-auto text-center animate-on-scroll">
        <p class="text-caption text-[#a5b4fc] font-medium tracking-wide uppercase mb-3">Desktop & Web UI</p>
        <h2 class="text-h2 text-neutral-100 mb-6">CLI부터 데스크톱 앱까지, 원하는 방식으로 사용하세요</h2>
        <p class="text-body-lg text-neutral-400 mb-12 max-w-2xl mx-auto">
          React/Vite 기반 Web UI로 대시보드, 채팅, 워크플로우를 시각적으로 관리하고, Tauri로 네이티브 데스크톱 앱을 배포합니다.
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 text-left">
          {[
            { title: 'Dashboard', desc: '시스템 상태, 패턴 통계, 실행 로그를 한눈에 확인합니다.' },
            { title: 'Chat', desc: '자연어로 에이전트와 대화하며 작업을 지시합니다.' },
            { title: 'Workflows', desc: 'n8n 워크플로우를 시각적으로 관리하고 편집합니다.' },
            { title: 'Routines', desc: '감지된 패턴과 자동화 추천을 확인합니다.' },
            { title: 'Audit Log', desc: '모든 실행 이력과 보안 이벤트를 추적합니다.' },
            { title: 'Settings', desc: '환경 설정, API 키, 보안 정책을 구성합니다.' },
          ].map((item) => (
            <div class="bg-[#14161b] rounded-lg p-6 border border-white/10">
              <h3 class="text-h4 text-neutral-100 mb-2">{item.title}</h3>
              <p class="text-caption text-neutral-400">{item.desc}</p>
            </div>
          ))}
        </div>
      </div>
    </Container>
  </Section>

  <!-- FAQ -->
  <Section>
    <Container narrow>
      <div class="animate-on-scroll">
        <div class="text-center mb-12">
          <h2 class="text-h2 text-neutral-100 mb-4">자주 묻는 질문</h2>
          <p class="text-body-lg text-neutral-400">설치, 보안, 기능에 대한 핵심 질문들.</p>
        </div>
        <Accordion items={faqItems} />
      </div>
    </Container>
  </Section>

  <!-- CTA -->
  <Section background="dark">
    <Container>
      <div class="text-center animate-on-scroll">
        <h2 class="text-h2 text-white mb-4">지금 바로 시작하세요</h2>
        <p class="text-body-lg text-neutral-400 max-w-xl mx-auto mb-10">
          Clone, 빌드, 실행까지 5분이면 충분합니다. 73개+ Rust 모듈의 성능을 직접 경험하세요.
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <Button variant="primary" size="lg" href="/docs/getting-started">시작하기</Button>
          <Button variant="ghost" size="lg" href="https://github.com/AllvIa-ALLRounder/main" external>GitHub</Button>
        </div>
      </div>
    </Container>
  </Section>

  <Footer slot="footer" />
</BaseLayout>
